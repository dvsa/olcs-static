<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for components/splitScreen.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../prettify.css">
    <link rel="stylesheet" href="../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header low">
    <h1>Code coverage report for <span class="entity">components/splitScreen.js</span></h1>
    <h2>
        Statements: <span class="metric">15.73% <small>(14 / 89)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">4.17% <small>(1 / 24)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">5.56% <small>(1 / 18)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">15.73% <small>(14 / 89)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; <a href="index.html">components/</a> &#187; splitScreen.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181</td><td class="line-coverage"><span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">var OLCS = OLCS || <span class="branch-1 cbranch-no" title="branch not covered" >{};</span>
&nbsp;
/**
 * Split screen
 *
 * Handles the splitScreen js
 */
&nbsp;
OLCS.splitScreen = (function(document, $, undefined) {
&nbsp;
  'use strict';
&nbsp;
  return <span class="fstat-no" title="function not covered" >function init() {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var url1;</span>
<span class="cstat-no" title="statement not covered" >    var url2;</span>
<span class="cstat-no" title="statement not covered" >    var orientation;</span>
<span class="cstat-no" title="statement not covered" >    var isVisible;</span>
<span class="cstat-no" title="statement not covered" >    var canStore;</span>
<span class="cstat-no" title="statement not covered" >    var orientationPreferenceIndex = 'OLCS.preferences.splitscreen.orientation';</span>
<span class="cstat-no" title="statement not covered" >    var mainFrame = $('#iframe-one');</span>
<span class="cstat-no" title="statement not covered" >    var sideFrame = $('#iframe-two');</span>
<span class="cstat-no" title="statement not covered" >    var panel = $('.iframe-controls');</span>
&nbsp;
    // Splits the hash fragment into the relevant variables, format is
    // #base64encode(url1|url2|orientation|isVisible)
<span class="fstat-no" title="function not covered" >    function splitHashFragment() {</span>
<span class="cstat-no" title="statement not covered" >      var parts = window.atob(window.location.hash.substring(1)).split('|');</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      url1 = parts[0];</span>
<span class="cstat-no" title="statement not covered" >      url2 = parts[1];</span>
<span class="cstat-no" title="statement not covered" >      orientation = parts[2] || null;</span>
<span class="cstat-no" title="statement not covered" >      isVisible = parts[3] === '0' ? false : true;</span>
    }
&nbsp;
    // Checks whether we can access local storage for preferences
<span class="fstat-no" title="function not covered" >    function checkStore() {</span>
<span class="cstat-no" title="statement not covered" >      try {</span>
<span class="cstat-no" title="statement not covered" >        localStorage.setItem('checkStore', true);</span>
<span class="cstat-no" title="statement not covered" >        canStore = true;</span>
      } catch (err) {
<span class="cstat-no" title="statement not covered" >        canStore = false;</span>
      }
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function isValidOrientation(orientation) {</span>
<span class="cstat-no" title="statement not covered" >      return $.inArray(orientation, ['vertical', 'horizontal', 'closed']) !== -1;</span>
    }
&nbsp;
    // Grabs the default orientation,
    //  - checks the hash fragment first
    //  - then checks local storage preferences
<span class="fstat-no" title="function not covered" >    function getDefaultOrientation() {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      var defaultOrientation;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (isValidOrientation(orientation)) {</span>
<span class="cstat-no" title="statement not covered" >        return orientation;</span>
      }
&nbsp;
<span class="cstat-no" title="statement not covered" >      defaultOrientation = getOrientationPreference();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (!isValidOrientation(defaultOrientation)) {</span>
<span class="cstat-no" title="statement not covered" >        defaultOrientation = 'horizontal';</span>
      }
&nbsp;
<span class="cstat-no" title="statement not covered" >      return defaultOrientation;</span>
    }
&nbsp;
    // Grab the orientation preference from local storage if we can
<span class="fstat-no" title="function not covered" >    function getOrientationPreference() {</span>
<span class="cstat-no" title="statement not covered" >      if (canStore) {</span>
<span class="cstat-no" title="statement not covered" >        return localStorage.getItem(orientationPreferenceIndex);</span>
      }
    }
&nbsp;
    // Save our current orientation to the preferences local storage if we can
<span class="fstat-no" title="function not covered" >    function setOrientationPreference(orientation) {</span>
<span class="cstat-no" title="statement not covered" >      if (canStore) {</span>
<span class="cstat-no" title="statement not covered" >        localStorage.setItem(orientationPreferenceIndex, orientation);</span>
      }
    }
&nbsp;
    // Called when the close button is clicked
<span class="fstat-no" title="function not covered" >    function close() {</span>
      // Resize the iframe
<span class="cstat-no" title="statement not covered" >      mainFrame.attr('class', 'iframe--full');</span>
&nbsp;
      // We need to update the hash to remember that we are closed
      // in case someone refreshes the page
<span class="cstat-no" title="statement not covered" >      orientation = 'closed';</span>
<span class="cstat-no" title="statement not covered" >      updateHashFragment();</span>
&nbsp;
      // We no longer care about the side frame or panel so we can remove them
<span class="cstat-no" title="statement not covered" >      sideFrame.remove();</span>
<span class="cstat-no" title="statement not covered" >      panel.remove();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      mainFrame.contents().find('form,a').each(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >        if (!$(this).attr('target')) {</span>
<span class="cstat-no" title="statement not covered" >          $(this).attr('target', '_parent');</span>
        }
      });
&nbsp;
<span class="cstat-no" title="statement not covered" >      OLCS.preloader.hide();</span>
    }
&nbsp;
    // Update the has fragment in the url
<span class="fstat-no" title="function not covered" >    function updateHashFragment() {</span>
<span class="cstat-no" title="statement not covered" >      var string = url1 + '|' + url2 + '|' + orientation + '|' + (isVisible ? '1' : '0');</span>
<span class="cstat-no" title="statement not covered" >      window.location.hash = '#' + window.btoa(string);</span>
    }
&nbsp;
    // @param {string} newOrientation
<span class="fstat-no" title="function not covered" >    function setOrientation(newOrientation) {</span>
<span class="cstat-no" title="statement not covered" >      orientation = newOrientation;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      setOrientationPreference(orientation);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      mainFrame.attr('class', 'iframe--' + orientation);</span>
<span class="cstat-no" title="statement not covered" >      sideFrame.attr('class', 'iframe--' + orientation);</span>
<span class="cstat-no" title="statement not covered" >      panel.attr('class', 'iframe-controls ' + orientation);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      updateHashFragment();</span>
    }
&nbsp;
    // Called when we toggle collapsing the split screen
<span class="fstat-no" title="function not covered" >    function toggleVisible() {</span>
<span class="cstat-no" title="statement not covered" >      isVisible = !isVisible;</span>
<span class="cstat-no" title="statement not covered" >      updateHashFragment();</span>
<span class="cstat-no" title="statement not covered" >      panel.toggleClass('collapsed');</span>
<span class="cstat-no" title="statement not covered" >      sideFrame.toggleClass('collapsed');</span>
<span class="cstat-no" title="statement not covered" >      mainFrame.filter('.iframe--horizontal').toggleClass('full');</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function setUp() {</span>
<span class="cstat-no" title="statement not covered" >      splitHashFragment();</span>
&nbsp;
      // Start loading the iframes
<span class="cstat-no" title="statement not covered" >      mainFrame.attr('src', url1);</span>
<span class="cstat-no" title="statement not covered" >      sideFrame.attr('src', url2);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      checkStore();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (orientation === 'closed') {</span>
<span class="cstat-no" title="statement not covered" >        OLCS.preloader.show();</span>
<span class="cstat-no" title="statement not covered" >        mainFrame.attr('class', 'iframe--full');</span>
<span class="cstat-no" title="statement not covered" >        panel.remove();</span>
        // In this case, we have to wait for the mainFrame to load before calling close,
        // otherwise it won't set target parent on anything
<span class="cstat-no" title="statement not covered" >        $(mainFrame).on('load', <span class="fstat-no" title="function not covered" >function() {</span></span>
<span class="cstat-no" title="statement not covered" >          close();</span>
        });
      } else {
<span class="cstat-no" title="statement not covered" >        setOrientation(getDefaultOrientation());</span>
      }
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (!isVisible) {</span>
<span class="cstat-no" title="statement not covered" >        toggleVisible();</span>
      }
    }
&nbsp;
    // Listeners
<span class="cstat-no" title="statement not covered" >    $(document).on('click', '.iframe-controls--orientation', <span class="fstat-no" title="function not covered" >function toggledOrientation(e) {</span></span>
<span class="cstat-no" title="statement not covered" >      e.preventDefault();</span>
<span class="cstat-no" title="statement not covered" >      setOrientation(orientation === 'vertical' ? 'horizontal' : 'vertical');</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    $(document).on('click', '.iframe-controls--toggle', <span class="fstat-no" title="function not covered" >function toggledVisibility(e) {</span></span>
<span class="cstat-no" title="statement not covered" >      e.preventDefault();</span>
<span class="cstat-no" title="statement not covered" >      toggleVisible();</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    $(document).on('click', '.iframe-controls--close', <span class="fstat-no" title="function not covered" >function closeSplitScreen(e) {</span></span>
<span class="cstat-no" title="statement not covered" >      e.preventDefault();</span>
<span class="cstat-no" title="statement not covered" >      close();</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    setUp();</span>
  };
}(document, window.jQuery));
&nbsp;</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Thu May 26 2016 11:55:54 GMT+0100 (BST)</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
